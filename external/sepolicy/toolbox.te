# Any toolbox command run by init.
# At present, the only known usage is for running mkswap via fs_mgr.
# Do NOT use this domain for toolbox when run by any other domain.
type toolbox, domain;
type toolbox_exec, exec_type, file_type;

init_daemon_domain(toolbox)

# /dev/__null__ created by init prior to policy load,
# open fd inherited by fsck.
allow toolbox tmpfs:chr_file { read write ioctl };

# Inherit and use pty created by android_fork_execvp_ext().
allow toolbox devpts:chr_file { read write getattr ioctl };

# mkswap-specific.
# Read/write block devices used for swap partitions.
# Assign swap_block_device type any such partition in your
# device/<vendor>/<product>/sepolicy/file_contexts file.
allow toolbox block_device:dir search;
allow toolbox swap_block_device:blk_file rw_file_perms;

# Only allow entry from init via the toolbox binary.
neverallow { domain -init } toolbox:process transition;
neverallow domain toolbox:process dyntransition;
neverallow toolbox { file_type fs_type -toolbox_exec}:file entrypoint;




allow toolbox property_socket:sock_file write;

allow toolbox storage_file:dir {search read write};
allow toolbox storage_file:lnk_file read;

allow toolbox init:fifo_file {read write getattr} ;
allow toolbox init:unix_stream_socket connectto;

allow toolbox fuse:dir {search read write};
allow toolbox fuse:file {open read write getattr};

allow toolbox self:udp_socket {create ioctl getattr};
allow toolbox self:capability {dac_override net_raw net_admin};

allow toolbox mnt_user_file:dir {search read write};
allow toolbox mnt_user_file:lnk_file {read write};

allow toolbox system_data_file:dir setattr;

allow toolbox tombstone_data_file:dir {search read write};


 
